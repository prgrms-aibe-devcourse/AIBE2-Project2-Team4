<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>프로필 수정</title>
    <style>
        body { font-family: sans-serif; margin: 2rem; }
        label { display: block; margin-top: 1rem; font-weight: bold; }
        input, textarea { width: 100%; padding: 0.5rem; margin-top: 0.3rem; }
        button { margin-top: 1rem; padding: 0.4rem 0.8rem; }
        ul { list-style: none; padding: 0; }
        li { display: flex; align-items: center; gap: 0.5rem; margin: 0.5rem 0; }
    </style>
</head>
<body>
<h1>프로필 수정</h1>

<form th:action="@{/profile/edit}" method="post" id="profileForm">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

    <label>포지션</label>
    <input type="text" name="position" th:value="${profile.position}" />

    <label>소개글</label>
    <textarea name="bio" rows="5" th:text="${profile.bio}"></textarea>

    <label>기술 스택</label>
    <ul id="skillList">
        <!-- 기존 스킬을 hidden input 과 함께 렌더링 -->
        <li th:each="s : ${skills}">
            <span th:text="${s}"></span>
            <button type="button" onclick="removeSkill(this)">❌</button>
            <input type="hidden" name="skills" th:value="${s}" />
        </li>
    </ul>

    <input type="text" id="newSkillInput" placeholder="새 기술 입력" />
    <button type="button" onclick="addSkill()">➕ 추가</button>

    <br/><br/>
    <button type="submit">💾 저장</button>
    <button type="button" onclick="location.href='/profile'">← 돌아가기</button>
</form>

<script>
    function addSkill() {
        const input = document.getElementById('newSkillInput');
        const val = input.value.trim();
        if (!val) return;
        const ul = document.getElementById('skillList');
        const li = document.createElement('li');
        li.innerHTML = `
            <span>${val}</span>
            <button type="button" onclick="removeSkill(this)">❌</button>
            <input type="hidden" name="skills" value="${val}" />
        `;
        ul.appendChild(li);
        input.value = '';
        input.focus();
    }

    function removeSkill(btn) {
        btn.closest('li').remove();
    }
</script>
</body>
</html>