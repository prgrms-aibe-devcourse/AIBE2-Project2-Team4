<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">

<head layout:fragment="head">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title th:text="${project.title} + ' - PortPilot'">프로젝트 상세</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
          rel="stylesheet"/>

    <!-- 프로젝트 전용 CSS -->
    <link th:href="@{/css/project/project.css}" rel="stylesheet"/>

    <!-- FontAwesome (아이콘용) -->
    <script src="https://kit.fontawesome.com/your-fontawesome-kit.js"
            crossorigin="anonymous"></script>
</head>

<body>
<div layout:fragment="content" class="project-page">
    <div class="container py-5">
        <!-- 뒤로 가기 -->
        <a th:href="@{/projects}" class="btn btn-link mb-4">
            <i class="fas fa-arrow-left"></i> 프로젝트 목록으로
        </a>

        <div class="card">
            <div class="card-header">
                <h2 th:text="${project.title}">프로젝트 제목</h2>
                <small class="text-muted">
                    등록일: <span th:text="${#temporals.format(project.createdAt,'yyyy-MM-dd')}"></span>
                    &nbsp;|&nbsp;
                    상태: <span th:text="${project.status}"></span>
                </small>
            </div>
            <div class="card-body">
                <!-- 설명 -->
                <h5>설명</h5>
                <p th:text="${project.description}">설명 내용</p>

                <!-- 상세 정보 목록 -->
                <ul class="list-group list-group-flush mb-4">
                    <li class="list-group-item">
                        <strong>모집 마감일:</strong>
                        <span th:text="${#temporals.format(project.deadline,'yyyy-MM-dd HH:mm')}"></span>
                    </li>
                    <li class="list-group-item">
                        <strong>예상 시작일:</strong>
                        <span th:text="${project.startOption.label}"></span>
                    </li>
                    <li class="list-group-item">
                        <strong>진행 분류:</strong>
                        <span th:text="${project.projectType.label}"></span>
                    </li>
                    <li class="list-group-item">
                        <strong>기획 상태:</strong>
                        <span th:text="${project.planningState.label}"></span>
                    </li>
                    <li class="list-group-item">
                        <strong>프로젝트 경험:</strong>
                        <span th:text="${project.experience.label}"></span>
                    </li>
                    <li class="list-group-item">
                        <strong>협업 예정 인력:</strong>
                        <span th:text="${project.collaborationOption.label}"></span>
                    </li>
                </ul>

                <!-- 액션 버튼 -->
                <div class="d-flex">
                    <!-- 참여하기 -->
                    <form th:action="@{/projects/join/{id}(id=${project.id})}"
                          th:if="${principal != null and principal.id != project.owner.id and !member}"
                          method="post"
                          class="me-2">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" class="btn btn-outline-success">참여하기</button>
                    </form>

                    <!-- 수정 -->
                    <a th:href="@{/projects/edit/{id}(id=${project.id})}"
                       th:if="${principal != null and principal.id == project.owner.id}"
                       class="btn btn-outline-primary me-2">
                        수정
                    </a>

                    <!-- 삭제 -->
                    <form th:action="@{/projects/delete/{id}(id=${project.id})}"
                          th:if="${principal != null and principal.id == project.owner.id}"
                          method="post"
                          onsubmit="return confirm('정말 이 프로젝트를 삭제하시겠습니까?');">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" class="btn btn-outline-danger">삭제</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
